C51 COMPILER V9.56.0.0   HTTP_AP                                                           07/22/2020 17:31:04 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE HTTP_AP
OBJECT MODULE PLACED IN .\Objects\http_ap.obj
COMPILER INVOKED BY: D:\Program Files (x86)\keil5\C51\BIN\C51.EXE APP\http_ap.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\
                    -STC_LIB;.\APP) DEBUG OBJECTEXTEND PRINT(.\Listings\http_ap.lst) TABS(2) OBJECT(.\Objects\http_ap.obj)

line level    source

   1          #include "http_ap.h"
   2          #include "wifi.h"
   3          #include "string.h"
   4          #include "debug.h"
   5          
   6          #define AP_MSG_KEYWORD  "+PID,"
   7          
   8          u8 code HTTP_H1[]="HTTP/1.0 200 OK\r\n\
   9          Content-Type: text/html; charset=utf-8\r\n\
  10          Content-Length: ";
  11          
  12          u8 code HTTP_INDEX_CONTENT[]  = "<!DOCTYPE html>\r\n\
  13          <html lang=\"en\">\r\n\
  14          <head>\r\n\
  15              <meta charset=\"UTF-8\">\r\n\
  16              <title>Genius AI Lab</title>\r\n\
  17              <style>\r\n\
  18                  h1{font-size:600%;text-align:center}\r\n\
  19                  span{font-size:300%;margin-left:40px}\r\n\
  20                  button{type:button;margin-left:40px;width:120px;height:120px;border-radius:60px;padding:20px}\r\n\
  21                  .ss1{background:#ff9953}\r\n\
  22                  .ss2{background:darkgray}\r\n\
  23                  .ss3{background: #ffe0a0}\r\n\
  24                  .ss4{background: #d6d6d6}\r\n\
  25                  .ss5{border-radius:20px;height:60px}\r\n\
  26              </style>\r\n\
  27              <script>\r\n\
  28                  function jp(a)\r\n\
  29                  {window.location.href=\"/?\"+a}\r\n\
  30              </script>\r\n\
  31          </head>\r\n\
  32          <body>\r\n\
  33              <div style=\"width:1000px\">\r\n\
  34                  <div style=\"background-color:slategray\">\r\n\
  35                      <h1>Genius AI Lab</h1>\r\n\
  36                  </div>\r\n\
  37                  <br>\r\n\
  38                          <span>SWITCH1:</span>\r\n\
  39                          <button class=\"ss1\" onclick=\"jp('SWITCH1=ON')\">ON</button>\r\n\
  40                          <button class=\"ss2\" onclick=\"jp('SWITCH1=OFF')\">OFF</button>\r\n\
  41                          <br>\r\n\
  42                          <span>SWITCH2:</span>\r\n\
  43                          <button class=\"ss1\" onclick=\"jp('SWITCH2=ON')\">ON</button>\r\n\
  44                          <button class=\"ss2\" onclick=\"jp('SWITCH2=OFF')\">OFF</button><br>\r\n\
  45                          <span>SWITCH3:</span>\r\n\
  46                          <button class=\"ss1\" onclick=\"jp('SWITCH3=ON')\">ON</button>\r\n\
  47                          <button class=\"ss2\" onclick=\"jp('SWITCH3=OFF')\">OFF</button><br>\r\n\
  48                          <span>SWITCH4:</span>\r\n\
  49                          <button class=\"ss1\" onclick=\"jp('SWITCH4=ON')\">ON</button>\r\n\
  50                          <button class=\"ss2\" onclick=\"jp('SWITCH4=OFF')\">OFF</button>\r\n\
  51                  <br>\r\n\
  52              </div>\r\n\
  53          </body>\r\n\
  54          </html>";
C51 COMPILER V9.56.0.0   HTTP_AP                                                           07/22/2020 17:31:04 PAGE 2   

  55          
  56          void AP_MSG_Handle(void)
  57          {
  58   1        u8 *p;
  59   1        u8 client_id[2];
  60   1        debug(WIFI_RBUF);
  61   1        if(strstr(WIFI_RBUF, AP_MSG_KEYWORD))
  62   1        {
  63   2          debug_vip(WIFI_RBUF + sizeof(AP_MSG_KEYWORD)-1);
  64   2          client_id[0] = *(WIFI_RBUF + sizeof(AP_MSG_KEYWORD)-1);
  65   2          client_id[1] = '\0';
  66   2          p = strstr(WIFI_RBUF, HTTP_REQUEST_INDEX);
  67   2          if(p)
  68   2          {
  69   3            http_send(client_id, HTTP_INDEX_CONTENT);
  70   3          }
  71   2          else
  72   2          {
  73   3            p = strstr(WIFI_RBUF, HTTP_REQUEST_CONTROL);
  74   3            if(p)
  75   3            {
  76   4              if(DevicesControl(p) == 1)
  77   4                http_send(HTTP_INDEX_CONTENT);
*** WARNING C209 IN LINE 77 OF APP\http_ap.c: '_http_send': too few actual parameters
  78   4              else
  79   4                http_send("Devices control Fail !!!");
*** WARNING C209 IN LINE 79 OF APP\http_ap.c: '_http_send': too few actual parameters
  80   4            }
  81   3          }
  82   2        }
  83   1      }
  84          
  85          /**************************************************************************************
  86          u8 code HTTP_INDEX_CONTENT[]  = "<!DOCTYPE html>\r\n\
  87          <html lang=\"en\">\r\n\
  88          <head>\r\n\
  89              <meta charset=\"UTF-8\">\r\n\
  90              <title>Genius AI Lab</title>\r\n\
  91              <style>\r\n\
  92                  h1{font-size:600%;text-align:center}\r\n\
  93                  span{font-size:300%;margin-left:40px}\r\n\
  94                  button{type:button;margin-left:40px;width:120px;height:120px;border-radius:60px;padding:20px}\r\n\
  95                  .ss1{background:#ff9953}\r\n\
  96                  .ss2{background:darkgray}\r\n\
  97                  .ss3{background: #ffe0a0}\r\n\
  98                  .ss4{background: #d6d6d6}\r\n\
  99                  .ss5{border-radius:20px;height:60px}\r\n\
 100              </style>\r\n\
 101              <script>\r\n\
 102                  function jp(a)\r\n\
 103                  {window.location.href=\"/?\"+a}\r\n\
 104              </script>\r\n\
 105          </head>\r\n\
 106          <body>\r\n\
 107              <div style=\"width:1000px\">\r\n\
 108                  <div style=\"background-color:slategray\">\r\n\
 109                      <h1>Genius AI Lab</h1>\r\n\
 110                  </div>\r\n\
 111                  <br>\r\n\
 112                          <span>SWITCH1:</span>\r\n\
 113                          <button class=\"ss1\" onclick=\"jp('SWITCH1=ON')\">ON</button>\r\n\
 114                          <button class=\"ss2\" onclick=\"jp('SWITCH1=OFF')\">OFF</button>\r\n\
C51 COMPILER V9.56.0.0   HTTP_AP                                                           07/22/2020 17:31:04 PAGE 3   

 115                          <br>\r\n\
 116                          <span>SWITCH2:</span>\r\n\
 117                          <button class=\"ss1\" onclick=\"jp('SWITCH2=ON')\">ON</button>\r\n\
 118                          <button class=\"ss2\" onclick=\"jp('SWITCH2=OFF')\">OFF</button><br>\r\n\
 119                          <span>SWITCH3:</span>\r\n\
 120                          <button class=\"ss1\" onclick=\"jp('SWITCH3=ON')\">ON</button>\r\n\
 121                          <button class=\"ss2\" onclick=\"jp('SWITCH3=OFF')\">OFF</button><br>\r\n\
 122                          <span>SWITCH4:</span>\r\n\
 123                          <button class=\"ss1\" onclick=\"jp('SWITCH4=ON')\">ON</button>\r\n\
 124                          <button class=\"ss2\" onclick=\"jp('SWITCH4=OFF')\">OFF</button>\r\n\
 125                      <br>\r\n\
 126                  <br>\r\n\
 127                      <hr>\r\n\
 128                  <br>\r\n\
 129                  <span>LIGHT1:</span>\r\n\
 130                  <button class=\"ss1\" onclick=\"jp('LIGHT1=ON')\">ON</button>\r\n\
 131                  <button class=\"ss3\" onclick=\"jp('LIGHT1=INC')\">ADD</button>\r\n\
 132                  <button class=\"ss4\" onclick=\"jp('LIGHT1=DEC')\">DEC</button>\r\n\
 133                  <button class=\"ss2\" onclick=\"jp('LIGHT1=OFF')\">OFF</button><br>\r\n\
 134                  <span>LIGHT2:</span>\r\n\
 135                  <button class=\"ss1\" onclick=\"jp('LIGHT2=ON')\">ON</button>\r\n\
 136                  <button class=\"ss3\" onclick=\"jp('LIGHT2=INC')\">ADD</button>\r\n\
 137                  <button class=\"ss4\" onclick=\"jp('LIGHT2=ON')\">DEC</button>\r\n\
 138                  <button class=\"ss2\" onclick=\"jp('LIGHT2=DEC')\">OFF</button><br>\r\n\
 139                  <br>\r\n\
 140                      <hr>\r\n\
 141                  <br>\r\n\
 142                  <span>Tempreture: <span id=\"tp\">30 'C</span></span><button class=\"ss5\" onclick=\"jp('REFRESH')
             -\">Refresh</button><br>\r\n\
 143                  <span>Humidity: <span id=\"hu\">70%</span></span><br>\r\n\
 144              </div>\r\n\
 145          </body>\r\n\
 146          </html>";
 147          */
 148          /*
 149          u8 code HTTP_INDEX_CONTENT[]  = "<!DOCTYPE html>\r\n\
 150          <html lang=\"en\">\r\n\
 151          <head>\r\n\
 152              <meta charset=\"UTF-8\">\r\n\
 153              <title>Genius AI Lab</title>\r\n\
 154              <style>\r\n\
 155                  h1{font-size:600%;text-align:center}\r\n\
 156                  .wd{font-size:300%;margin-left:40px}\r\n\
 157                  button{type:submit;margin-left:40px;width:120px;height:120px;border-radius:60px;padding:20px}\r\n\
 158                  .sw1{background:#ff9953;value:ON}\r\n\
 159                  .sw2{background:darkgray;value:OFF}\r\n\
 160              </style>\r\n\
 161          </head>\r\n\
 162          <body>\r\n\
 163              <div style=\"width:1000px\">\r\n\
 164                  <div style=\"background-color:slategray\">\r\n\
 165                      <h1>Genius AI Lab</h1>\r\n\
 166                  </div>\r\n\
 167                  <br>\r\n\
 168                      <form name=\"sw\" action=\"table\" method=\"post\">\r\n\
 169                          <span class=\"wd\">SWITCH1:</span>\r\n\
 170                          <button class=\"sw1\" name=\"SWITCH1\">ON</button>\r\n\
 171                          <button class=\"sw2\" name=\"SWITCH1\">OFF</button>\r\n\
 172                          <br>\r\n\
 173                          <span class=\"wd\">SWITCH2:</span>\r\n\
 174                          <button class=\"sw1\" name=\"SWITCH2\">ON</button>\r\n\
 175                          <button class=\"sw2\" name=\"SWITCH2\">OFF</button><br>\r\n\
C51 COMPILER V9.56.0.0   HTTP_AP                                                           07/22/2020 17:31:04 PAGE 4   

 176                          <span class=\"wd\">SWITCH3:</span>\r\n\
 177                          <button class=\"sw1\" name=\"SWITCH3\">ON</button>\r\n\
 178                          <button class=\"sw2\" name=\"SWITCH3\">OFF</button><br>\r\n\
 179                          <span class=\"wd\">SWITCH4:</span>\r\n\
 180                          <button class=\"sw1\" name=\"SWITCH4\">ON</button>\r\n\
 181                          <button class=\"sw2\" name=\"SWITCH4\">OFF</button>\r\n\
 182                      </form>\r\n\
 183                      <br>\r\n\
 184                      <hr>\r\n\
 185              </div>\r\n\
 186              <br>\r\n\
 187          </body>\r\n\
 188          </html>";
 189          
 190          
 191          
 192          
 193          */
 194          /*
 195          u8 const WIFI_PAGE[]  = "HTTP/1.1 200 OK
 196          Content-Type: text/html
 197          Content-Length:361
 198          
 199          <html>
 200          <body>
 201          <h1>欢迎您使用天才的AI实验设备</h1>
 202          <p>请您输入WIFI名称和密码，通过此WIFI，设备可以连接到天才云。</p>
 203          <form action=\"/wifiset.html\">
 204          WIFI名称:<br>
 205          <input type=\"text\" name=\"firstname\" value=\"Louiswoo\">
 206          <br>
 207          密码:<br>
 208          <input type=\"text\" name=\"lastname\" value=\"Genius\">
 209          <br><br>
 210          <input type=\"submit\" value=\"连接\">
 211          </form>
 212          </body>
 213          </html>";
 214          
 215          u8 const CONNECTED_PAGE[] = "HTTP/1.1 200 OK
 216          Content-Type: text/html
 217          Content-Length:77
 218          
 219          <html>
 220          <body>
 221          <h1>WIFI成功连接，感谢您使用天才云！</h1>
 222          </body>
 223          </html>";
 224          
 225          u8 const PORTAL_PAGE[]  = "HTTP/1.0 200 OK\r\n\
 226          Content-Type: text/html; charset=utf-8\r\n\
 227          Content-Length: 149\r\n\
 228          Server: Werkzeug/1.0.1 Python/3.8.1\r\n\
 229          Date: Tue, 14 Jul 2020 09:12:38 GMT\r\n\
 230          \r\n\
 231          <!DOCTYPE html>\r\n\
 232          <html lang=\"en\">\r\n\
 233          <head>\r\n\
 234              <meta charset=\"UTF-8\">\r\n\
 235              <title>Geni</title>\r\n\
 236          </head>\r\n\
 237          <body>\r\n\
C51 COMPILER V9.56.0.0   HTTP_AP                                                           07/22/2020 17:31:04 PAGE 5   

 238              i am a Genius!!!\r\n\
 239          </body>\r\n\
 240          </html>";
 241          
 242          */


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    191    ----
   CONSTANT SIZE    =   1734    ----
   XDATA SIZE       =   ----       5
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
