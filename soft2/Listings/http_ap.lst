C51 COMPILER V9.56.0.0   HTTP_AP                                                           07/23/2020 00:05:03 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE HTTP_AP
OBJECT MODULE PLACED IN .\Objects\http_ap.obj
COMPILER INVOKED BY: d:\Keil_v5\C51\BIN\C51.EXE APP\http_ap.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\STC_LIB;.\APP) DEB
                    -UG OBJECTEXTEND PRINT(.\Listings\http_ap.lst) TABS(2) OBJECT(.\Objects\http_ap.obj)

line level    source

   1          #include "http_ap.h"
   2          #include "wifi.h"
   3          #include "string.h"
   4          #include "debug.h"
   5          
   6          #define AP_MSG_KEYWORD  "+IPD,"
   7          
   8          u8 code HTTP_H1[]="HTTP/1.0 200 OK\r\n\
   9          Content-Type: text/html; charset=utf-8\r\n\
  10          Content-Length: ";
  11          
  12          u8 code HTTP_INDEX_CONTENT[]  = "<!DOCTYPE html>\r\n\
  13          <html lang=\"en\">\r\n\
  14          <head>\r\n\
  15              <meta charset=\"UTF-8\">\r\n\
  16              <title>Genius AI Lab</title>\r\n\
  17              <style>\r\n\
  18                  h1{font-size:600%;text-align:center}\r\n\
  19                  span{font-size:300%;margin-left:40px}\r\n\
  20                  button{type:button;margin-left:40px;width:120px;height:120px;border-radius:60px;padding:20px}\r\n\
  21                  .ss1{background:#ff9953}\r\n\
  22                  .ss2{background:darkgray}\r\n\
  23                  .ss3{background: #ffe0a0}\r\n\
  24                  .ss4{background: #d6d6d6}\r\n\
  25                  .ss5{border-radius:20px;height:60px}\r\n\
  26              </style>\r\n\
  27              <script>\r\n\
  28                  function jp(a)\r\n\
  29                  {window.location.href=\"/?\"+a}\r\n\
  30              </script>\r\n\
  31          </head>\r\n\
  32          <body>\r\n\
  33              <div style=\"width:1000px\">\r\n\
  34                  <div style=\"background-color:slategray\">\r\n\
  35                      <h1>Genius AI Lab</h1>\r\n\
  36                  </div>\r\n\
  37                  <br>\r\n\
  38                          <span>SWITCH1:</span>\r\n\
  39                          <button class=\"ss1\" onclick=\"jp('SWITCH1=ON')\">ON</button>\r\n\
  40                          <button class=\"ss2\" onclick=\"jp('SWITCH1=OFF')\">OFF</button>\r\n\
  41                          <br>\r\n\
  42                          <span>SWITCH2:</span>\r\n\
  43                          <button class=\"ss1\" onclick=\"jp('SWITCH2=ON')\">ON</button>\r\n\
  44                          <button class=\"ss2\" onclick=\"jp('SWITCH2=OFF')\">OFF</button><br>\r\n\
  45                          <span>SWITCH3:</span>\r\n\
  46                          <button class=\"ss1\" onclick=\"jp('SWITCH3=ON')\">ON</button>\r\n\
  47                          <button class=\"ss2\" onclick=\"jp('SWITCH3=OFF')\">OFF</button><br>\r\n\
  48                          <span>SWITCH4:</span>\r\n\
  49                          <button class=\"ss1\" onclick=\"jp('SWITCH4=ON')\">ON</button>\r\n\
  50                          <button class=\"ss2\" onclick=\"jp('SWITCH4=OFF')\">OFF</button>\r\n\
  51                  <br>\r\n\
  52              </div>\r\n\
  53          </body>\r\n\
  54          </html>";
C51 COMPILER V9.56.0.0   HTTP_AP                                                           07/23/2020 00:05:03 PAGE 2   

  55          
  56          void AP_MSG_Handle(void)
  57          {
  58   1        u8 *p, *temp;
  59   1        u8 client_id[2];
  60   1        debug_vip(WIFI_RBUF);
  61   1        temp = strstr(WIFI_RBUF, "HTTP");
  62   1        *temp = 0x00;
  63   1        p = strstr(WIFI_RBUF, AP_MSG_KEYWORD);
  64   1        if(p)
  65   1        {
  66   2          p = p + sizeof(AP_MSG_KEYWORD)-1;
  67   2          debug_vip(p);
  68   2          client_id[0] = *p;
  69   2          client_id[1] = '\0';
  70   2          p = strstr(WIFI_RBUF, HTTP_REQUEST_INDEX);
  71   2          if(p)
  72   2          {
  73   3            http_send(client_id, HTTP_INDEX_CONTENT);
  74   3          }
  75   2          else
  76   2          {
  77   3            p = strstr(WIFI_RBUF, HTTP_REQUEST_CONTROL);
  78   3            if(p)
  79   3            {
  80   4              if(DevicesControl(p) == 1)
  81   4                http_send(client_id, HTTP_INDEX_CONTENT);
  82   4              else
  83   4                http_send(client_id, "Devices control Fail !!!");
  84   4            }
  85   3          }
  86   2        }
  87   1      }
  88          
  89          /**************************************************************************************
  90          u8 code HTTP_INDEX_CONTENT[]  = "<!DOCTYPE html>\r\n\
  91          <html lang=\"en\">\r\n\
  92          <head>\r\n\
  93              <meta charset=\"UTF-8\">\r\n\
  94              <title>Genius AI Lab</title>\r\n\
  95              <style>\r\n\
  96                  h1{font-size:600%;text-align:center}\r\n\
  97                  span{font-size:300%;margin-left:40px}\r\n\
  98                  button{type:button;margin-left:40px;width:120px;height:120px;border-radius:60px;padding:20px}\r\n\
  99                  .ss1{background:#ff9953}\r\n\
 100                  .ss2{background:darkgray}\r\n\
 101                  .ss3{background: #ffe0a0}\r\n\
 102                  .ss4{background: #d6d6d6}\r\n\
 103                  .ss5{border-radius:20px;height:60px}\r\n\
 104              </style>\r\n\
 105              <script>\r\n\
 106                  function jp(a)\r\n\
 107                  {window.location.href=\"/?\"+a}\r\n\
 108              </script>\r\n\
 109          </head>\r\n\
 110          <body>\r\n\
 111              <div style=\"width:1000px\">\r\n\
 112                  <div style=\"background-color:slategray\">\r\n\
 113                      <h1>Genius AI Lab</h1>\r\n\
 114                  </div>\r\n\
 115                  <br>\r\n\
 116                          <span>SWITCH1:</span>\r\n\
C51 COMPILER V9.56.0.0   HTTP_AP                                                           07/23/2020 00:05:03 PAGE 3   

 117                          <button class=\"ss1\" onclick=\"jp('SWITCH1=ON')\">ON</button>\r\n\
 118                          <button class=\"ss2\" onclick=\"jp('SWITCH1=OFF')\">OFF</button>\r\n\
 119                          <br>\r\n\
 120                          <span>SWITCH2:</span>\r\n\
 121                          <button class=\"ss1\" onclick=\"jp('SWITCH2=ON')\">ON</button>\r\n\
 122                          <button class=\"ss2\" onclick=\"jp('SWITCH2=OFF')\">OFF</button><br>\r\n\
 123                          <span>SWITCH3:</span>\r\n\
 124                          <button class=\"ss1\" onclick=\"jp('SWITCH3=ON')\">ON</button>\r\n\
 125                          <button class=\"ss2\" onclick=\"jp('SWITCH3=OFF')\">OFF</button><br>\r\n\
 126                          <span>SWITCH4:</span>\r\n\
 127                          <button class=\"ss1\" onclick=\"jp('SWITCH4=ON')\">ON</button>\r\n\
 128                          <button class=\"ss2\" onclick=\"jp('SWITCH4=OFF')\">OFF</button>\r\n\
 129                      <br>\r\n\
 130                  <br>\r\n\
 131                      <hr>\r\n\
 132                  <br>\r\n\
 133                  <span>LIGHT1:</span>\r\n\
 134                  <button class=\"ss1\" onclick=\"jp('LIGHT1=ON')\">ON</button>\r\n\
 135                  <button class=\"ss3\" onclick=\"jp('LIGHT1=INC')\">ADD</button>\r\n\
 136                  <button class=\"ss4\" onclick=\"jp('LIGHT1=DEC')\">DEC</button>\r\n\
 137                  <button class=\"ss2\" onclick=\"jp('LIGHT1=OFF')\">OFF</button><br>\r\n\
 138                  <span>LIGHT2:</span>\r\n\
 139                  <button class=\"ss1\" onclick=\"jp('LIGHT2=ON')\">ON</button>\r\n\
 140                  <button class=\"ss3\" onclick=\"jp('LIGHT2=INC')\">ADD</button>\r\n\
 141                  <button class=\"ss4\" onclick=\"jp('LIGHT2=ON')\">DEC</button>\r\n\
 142                  <button class=\"ss2\" onclick=\"jp('LIGHT2=DEC')\">OFF</button><br>\r\n\
 143                  <br>\r\n\
 144                      <hr>\r\n\
 145                  <br>\r\n\
 146                  <span>Tempreture: <span id=\"tp\">30 'C</span></span><button class=\"ss5\" onclick=\"jp('REFRESH')
             -\">Refresh</button><br>\r\n\
 147                  <span>Humidity: <span id=\"hu\">70%</span></span><br>\r\n\
 148              </div>\r\n\
 149          </body>\r\n\
 150          </html>";
 151          */
 152          /*
 153          u8 code HTTP_INDEX_CONTENT[]  = "<!DOCTYPE html>\r\n\
 154          <html lang=\"en\">\r\n\
 155          <head>\r\n\
 156              <meta charset=\"UTF-8\">\r\n\
 157              <title>Genius AI Lab</title>\r\n\
 158              <style>\r\n\
 159                  h1{font-size:600%;text-align:center}\r\n\
 160                  .wd{font-size:300%;margin-left:40px}\r\n\
 161                  button{type:submit;margin-left:40px;width:120px;height:120px;border-radius:60px;padding:20px}\r\n\
 162                  .sw1{background:#ff9953;value:ON}\r\n\
 163                  .sw2{background:darkgray;value:OFF}\r\n\
 164              </style>\r\n\
 165          </head>\r\n\
 166          <body>\r\n\
 167              <div style=\"width:1000px\">\r\n\
 168                  <div style=\"background-color:slategray\">\r\n\
 169                      <h1>Genius AI Lab</h1>\r\n\
 170                  </div>\r\n\
 171                  <br>\r\n\
 172                      <form name=\"sw\" action=\"table\" method=\"post\">\r\n\
 173                          <span class=\"wd\">SWITCH1:</span>\r\n\
 174                          <button class=\"sw1\" name=\"SWITCH1\">ON</button>\r\n\
 175                          <button class=\"sw2\" name=\"SWITCH1\">OFF</button>\r\n\
 176                          <br>\r\n\
 177                          <span class=\"wd\">SWITCH2:</span>\r\n\
C51 COMPILER V9.56.0.0   HTTP_AP                                                           07/23/2020 00:05:03 PAGE 4   

 178                          <button class=\"sw1\" name=\"SWITCH2\">ON</button>\r\n\
 179                          <button class=\"sw2\" name=\"SWITCH2\">OFF</button><br>\r\n\
 180                          <span class=\"wd\">SWITCH3:</span>\r\n\
 181                          <button class=\"sw1\" name=\"SWITCH3\">ON</button>\r\n\
 182                          <button class=\"sw2\" name=\"SWITCH3\">OFF</button><br>\r\n\
 183                          <span class=\"wd\">SWITCH4:</span>\r\n\
 184                          <button class=\"sw1\" name=\"SWITCH4\">ON</button>\r\n\
 185                          <button class=\"sw2\" name=\"SWITCH4\">OFF</button>\r\n\
 186                      </form>\r\n\
 187                      <br>\r\n\
 188                      <hr>\r\n\
 189              </div>\r\n\
 190              <br>\r\n\
 191          </body>\r\n\
 192          </html>";
 193          
 194          
 195          
 196          
 197          */
 198          /*
 199          u8 const WIFI_PAGE[]  = "HTTP/1.1 200 OK
 200          Content-Type: text/html
 201          Content-Length:361
 202          
 203          <html>
 204          <body>
 205          <h1>欢迎您使用天才的AI实验设备</h1>
 206          <p>请您输入WIFI名称和密码，通过此WIFI，设备可以连接到天才云。</p>
 207          <form action=\"/wifiset.html\">
 208          WIFI名称:<br>
 209          <input type=\"text\" name=\"firstname\" value=\"Louiswoo\">
 210          <br>
 211          密码:<br>
 212          <input type=\"text\" name=\"lastname\" value=\"Genius\">
 213          <br><br>
 214          <input type=\"submit\" value=\"连接\">
 215          </form>
 216          </body>
 217          </html>";
 218          
 219          u8 const CONNECTED_PAGE[] = "HTTP/1.1 200 OK
 220          Content-Type: text/html
 221          Content-Length:77
 222          
 223          <html>
 224          <body>
 225          <h1>WIFI成功连接，感谢您使用天才云！</h1>
 226          </body>
 227          </html>";
 228          
 229          u8 const PORTAL_PAGE[]  = "HTTP/1.0 200 OK\r\n\
 230          Content-Type: text/html; charset=utf-8\r\n\
 231          Content-Length: 149\r\n\
 232          Server: Werkzeug/1.0.1 Python/3.8.1\r\n\
 233          Date: Tue, 14 Jul 2020 09:12:38 GMT\r\n\
 234          \r\n\
 235          <!DOCTYPE html>\r\n\
 236          <html lang=\"en\">\r\n\
 237          <head>\r\n\
 238              <meta charset=\"UTF-8\">\r\n\
 239              <title>Geni</title>\r\n\
C51 COMPILER V9.56.0.0   HTTP_AP                                                           07/23/2020 00:05:03 PAGE 5   

 240          </head>\r\n\
 241          <body>\r\n\
 242              i am a Genius!!!\r\n\
 243          </body>\r\n\
 244          </html>";
 245          
 246          */


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    264    ----
   CONSTANT SIZE    =   1739    ----
   XDATA SIZE       =   ----       5
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
